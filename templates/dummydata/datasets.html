{% extends 'base.html' %} {% load crispy_forms_filters %} {% block content %}

<h1>Data sets of {{ fakeschema.title }}</h1>
<form method="post" id="upload_form">
  {% csrf_token %}
  <input type="number" name="rows" id="rows_id"/>
  <button type="submit" class="btn btn-success" id="click-me" >Generate data</button>
</form>
<hr />
{% if fakeschema.schemadatasets.count == 0 %}
<p>No datasets yet.</p>
{%else%}
  <div id="datasets">
    {% include 'dummydata/table.html'%}
  </div>
{% endif %}
  <script>
  $(document).ready(function (){

         $(document).on('submit','#upload_form', function(e){
         e.preventDefault();

           $.ajax({
                type : "POST",
                url: "{% url 'dummydata:schema-detail' fakeschema.pk%}",
                data: {
                 rows : $('#rows_id').val(),
                 csrfmiddlewaretoken: '{{ csrf_token }}',
                 dataType: "json",

                },

                success: function(data){

                    $(`#datasets`).html(data["msg"])
                    document.getElementById("upload_form").reset()
                },

            });
                 });
  })
      </script>
{% endblock %}
